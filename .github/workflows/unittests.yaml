name: Unit Tests

on:
  push: 

jobs:
  lint:
    name: PS Script Analyzer
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
    - name: lint
      uses: devblackops/github-action-psscriptanalyzer@master
      with:
        sendComment: false
        settingsPath: lint/PSScriptAnalyser.ps1
        failOnErrors: false
        failOnWarnings: false
        failOnInfos: false
  test:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v2

    - name: Set up PowerShell
      uses: PowerShell/setup-powershell@v1
      with:
        powershell-version: '7.0' # Specify the desired PowerShell version

    - name: Install Pester
      run: |
        Install-Module -Name Pester -Force -AllowClobber
      shell: pwsh

    - name: Run Pester tests
      run: |
        # Change the path to your test file and script file accordingly
        Invoke-Pester -Path 'pester/*.Tests.ps1'
        
      shell: pwsh